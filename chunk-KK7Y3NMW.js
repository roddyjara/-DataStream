import{a as ne}from"./chunk-HJJX7XXA.js";import{a as U,b as c,c as $,d as L,g as Y,i as J,j as K,k as Q,l as W,m as X,o as Z,q as ee}from"./chunk-WK2RLTW3.js";import{a as H}from"./chunk-CTWZ4Y67.js";import{b as R,d as B}from"./chunk-VC6E4ROJ.js";import{f as A,g as z,j as V}from"./chunk-4LKPXAJC.js";import{a as te}from"./chunk-TEFFRFYT.js";import{Ca as q,Ha as d,N as v,Sa as m,Ta as o,Ua as t,Va as s,a as k,b as w,bb as D,db as u,hb as f,jb as l,kb as G,lb as p,mb as j,qa as i}from"./chunk-7AMOEM73.js";function re(r,a){if(r&1&&(o(0,"span",32),l(1),t()),r&2){let n=u();i(),p(" ",n.getErrorMessage("name")," ")}}function oe(r,a){if(r&1&&(o(0,"span",32),l(1),t()),r&2){let n=u();i(),p(" ",n.getErrorMessage("city")," ")}}function le(r,a){if(r&1&&(o(0,"span",32),l(1),t()),r&2){let n=u();i(),p(" ",n.getErrorMessage("address")," ")}}function ae(r,a){if(r&1&&(o(0,"span",32),l(1),t()),r&2){let n=u();i(),p(" ",n.getErrorMessage("phone")," ")}}function me(r,a){if(r&1&&(o(0,"span",32),l(1),t()),r&2){let n=u();i(),p(" ",n.getErrorMessage("email")," ")}}function ce(r,a){if(r&1&&(o(0,"span",32),l(1),t()),r&2){let n=u();i(),p(" ",n.getErrorMessage("serviceDate")," ")}}function de(r,a){if(r&1&&(o(0,"span",32),l(1),t()),r&2){let n=u();i(),p(" ",n.getErrorMessage("scheduledTime")," ")}}function se(r,a){if(r&1&&(o(0,"option",33),l(1),t()),r&2){let n=a.$implicit;m("value",n.id),i(),j(" ",n.firstName," ",n.lastName," ")}}function pe(r,a){if(r&1&&(o(0,"span",32),l(1),t()),r&2){let n=u();i(),p(" ",n.getErrorMessage("assignedEmployeeId")," ")}}var ie=class r{fb=v(Z);clientService=v(ne);authService=v(H);employeeService=v(te);route=v(R);router=v(B);clientForm;isEdit=!1;clientId=null;employees=this.employeeService.getEmployees();constructor(){this.clientForm=this.fb.group({name:["",[c.required,c.minLength(2)]],city:["",c.required],address:["",c.required],phone:["",[c.required,c.pattern(/^[\+]?[0-9\-\s\(\)]+$/)]],email:["",[c.required,c.email]],serviceDate:["",c.required],scheduledTime:["",c.required],actualTime:[""],assignedEmployeeId:["",c.required],observations:[""]})}ngOnInit(){if(this.clientId=this.route.snapshot.paramMap.get("id"),this.clientId){this.isEdit=!0;let a=this.clientService.getClientById(this.clientId);a&&this.clientForm.patchValue(w(k({},a),{serviceDate:a.serviceDate.toISOString().split("T")[0]}))}}onSubmit(){if(this.clientForm.valid){let a=this.clientForm.value,n=this.authService.currentUser(),e=w(k({},a),{serviceDate:new Date(a.serviceDate),status:this.isEdit?void 0:"pending",createdBy:n?.id||""});this.isEdit&&this.clientId?this.clientService.updateClient(this.clientId,e):this.clientService.addClient(e),this.router.navigate(["/clientes"])}else this.markFormGroupTouched()}markFormGroupTouched(){Object.keys(this.clientForm.controls).forEach(a=>{this.clientForm.get(a)?.markAsTouched()})}cancel(){this.router.navigate(["/clientes"])}getErrorMessage(a){let n=this.clientForm.get(a);return n?.hasError("required")?"Este campo es requerido":n?.hasError("email")?"Email inv\xE1lido":n?.hasError("minlength")?"M\xEDnimo 2 caracteres":n?.hasError("pattern")?"Formato inv\xE1lido":""}static \u0275fac=function(n){return new(n||r)};static \u0275cmp=q({type:r,selectors:[["app-client-form"]],decls:67,vars:29,consts:[[1,"client-form"],[1,"form-header"],[1,"btn-secondary",3,"click"],[1,"form",3,"ngSubmit","formGroup"],[1,"form-row"],[1,"form-group"],["for","name"],["id","name","type","text","formControlName","name"],["class","error-message",4,"ngIf"],["for","city"],["id","city","type","text","formControlName","city"],["for","address"],["id","address","type","text","formControlName","address"],["for","phone"],["id","phone","type","tel","formControlName","phone"],["for","email"],["id","email","type","email","formControlName","email"],["for","serviceDate"],["id","serviceDate","type","date","formControlName","serviceDate"],["for","scheduledTime"],["id","scheduledTime","type","text","formControlName","scheduledTime","placeholder","ej: 09:00-12:00"],["for","actualTime"],["id","actualTime","type","text","formControlName","actualTime","placeholder","ej: 09:15-11:45"],["for","assignedEmployeeId"],["id","assignedEmployeeId","formControlName","assignedEmployeeId"],["value",""],[3,"value",4,"ngFor","ngForOf"],["for","observations"],["id","observations","formControlName","observations","rows","4","placeholder","Detalles adicionales del servicio..."],[1,"form-actions"],["type","button",1,"btn-secondary",3,"click"],["type","submit",1,"btn-primary",3,"disabled"],[1,"error-message"],[3,"value"]],template:function(n,e){if(n&1&&(o(0,"div",0)(1,"div",1)(2,"h2"),l(3),t(),o(4,"button",2),D("click",function(){return e.cancel()}),l(5,"Cancelar"),t()(),o(6,"form",3),D("ngSubmit",function(){return e.onSubmit()}),o(7,"div",4)(8,"div",5)(9,"label",6),l(10,"Nombre / Raz\xF3n Social *"),t(),s(11,"input",7),d(12,re,2,1,"span",8),t(),o(13,"div",5)(14,"label",9),l(15,"Ciudad *"),t(),s(16,"input",10),d(17,oe,2,1,"span",8),t()(),o(18,"div",5)(19,"label",11),l(20,"Direcci\xF3n *"),t(),s(21,"input",12),d(22,le,2,1,"span",8),t(),o(23,"div",4)(24,"div",5)(25,"label",13),l(26,"Tel\xE9fono *"),t(),s(27,"input",14),d(28,ae,2,1,"span",8),t(),o(29,"div",5)(30,"label",15),l(31,"Email *"),t(),s(32,"input",16),d(33,me,2,1,"span",8),t()(),o(34,"div",4)(35,"div",5)(36,"label",17),l(37,"Fecha del Servicio *"),t(),s(38,"input",18),d(39,ce,2,1,"span",8),t(),o(40,"div",5)(41,"label",19),l(42,"Horario Programado *"),t(),s(43,"input",20),d(44,de,2,1,"span",8),t()(),o(45,"div",4)(46,"div",5)(47,"label",21),l(48,"Horario Real de Trabajo"),t(),s(49,"input",22),t(),o(50,"div",5)(51,"label",23),l(52,"Empleado Asignado *"),t(),o(53,"select",24)(54,"option",25),l(55,"Seleccionar empleado"),t(),d(56,se,2,3,"option",26),t(),d(57,pe,2,1,"span",8),t()(),o(58,"div",5)(59,"label",27),l(60,"Observaciones del Servicio"),t(),s(61,"textarea",28),t(),o(62,"div",29)(63,"button",30),D("click",function(){return e.cancel()}),l(64,"Cancelar"),t(),o(65,"button",31),l(66),t()()()()),n&2){let g,_,C,h,b,F,E,y,x,S,M,I,O,P,T,N;i(3),G(e.isEdit?"Editar Cliente":"Nuevo Cliente"),i(3),m("formGroup",e.clientForm),i(5),f("error",((g=e.clientForm.get("name"))==null?null:g.invalid)&&((g=e.clientForm.get("name"))==null?null:g.touched)),i(),m("ngIf",((_=e.clientForm.get("name"))==null?null:_.invalid)&&((_=e.clientForm.get("name"))==null?null:_.touched)),i(4),f("error",((C=e.clientForm.get("city"))==null?null:C.invalid)&&((C=e.clientForm.get("city"))==null?null:C.touched)),i(),m("ngIf",((h=e.clientForm.get("city"))==null?null:h.invalid)&&((h=e.clientForm.get("city"))==null?null:h.touched)),i(4),f("error",((b=e.clientForm.get("address"))==null?null:b.invalid)&&((b=e.clientForm.get("address"))==null?null:b.touched)),i(),m("ngIf",((F=e.clientForm.get("address"))==null?null:F.invalid)&&((F=e.clientForm.get("address"))==null?null:F.touched)),i(5),f("error",((E=e.clientForm.get("phone"))==null?null:E.invalid)&&((E=e.clientForm.get("phone"))==null?null:E.touched)),i(),m("ngIf",((y=e.clientForm.get("phone"))==null?null:y.invalid)&&((y=e.clientForm.get("phone"))==null?null:y.touched)),i(4),f("error",((x=e.clientForm.get("email"))==null?null:x.invalid)&&((x=e.clientForm.get("email"))==null?null:x.touched)),i(),m("ngIf",((S=e.clientForm.get("email"))==null?null:S.invalid)&&((S=e.clientForm.get("email"))==null?null:S.touched)),i(5),f("error",((M=e.clientForm.get("serviceDate"))==null?null:M.invalid)&&((M=e.clientForm.get("serviceDate"))==null?null:M.touched)),i(),m("ngIf",((I=e.clientForm.get("serviceDate"))==null?null:I.invalid)&&((I=e.clientForm.get("serviceDate"))==null?null:I.touched)),i(4),f("error",((O=e.clientForm.get("scheduledTime"))==null?null:O.invalid)&&((O=e.clientForm.get("scheduledTime"))==null?null:O.touched)),i(),m("ngIf",((P=e.clientForm.get("scheduledTime"))==null?null:P.invalid)&&((P=e.clientForm.get("scheduledTime"))==null?null:P.touched)),i(9),f("error",((T=e.clientForm.get("assignedEmployeeId"))==null?null:T.invalid)&&((T=e.clientForm.get("assignedEmployeeId"))==null?null:T.touched)),i(3),m("ngForOf",e.employees()),i(),m("ngIf",((N=e.clientForm.get("assignedEmployeeId"))==null?null:N.invalid)&&((N=e.clientForm.get("assignedEmployeeId"))==null?null:N.touched)),i(8),m("disabled",e.clientForm.invalid),i(),p(" ",e.isEdit?"Actualizar":"Crear"," Cliente ")}},dependencies:[V,A,z,ee,Y,W,X,U,Q,$,L,K,J],styles:[".client-form[_ngcontent-%COMP%]{max-width:800px;margin:0 auto;padding:2rem;background:#ffffff0d;border-radius:12px;border:1px solid rgba(255,255,255,.1)}.form-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:2rem;border-bottom:1px solid rgba(255,255,255,.1);padding-bottom:1rem}h2[_ngcontent-%COMP%]{color:#fff;margin:0}.form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1.5rem}.form-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:1.5rem}.form-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}label[_ngcontent-%COMP%]{color:#fff;font-weight:500;font-size:.9rem}input[_ngcontent-%COMP%], select[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%]{padding:.75rem;border:1px solid rgba(255,255,255,.2);border-radius:6px;background:#ffffff0d;color:#fff;font-size:1rem;transition:border-color .3s ease}input[_ngcontent-%COMP%]:focus, select[_ngcontent-%COMP%]:focus, textarea[_ngcontent-%COMP%]:focus{outline:none;border-color:#00d4ff;box-shadow:0 0 0 2px #00d4ff33}input.error[_ngcontent-%COMP%], select.error[_ngcontent-%COMP%], textarea.error[_ngcontent-%COMP%]{border-color:#dc3545}.error-message[_ngcontent-%COMP%]{color:#dc3545;font-size:.875rem}textarea[_ngcontent-%COMP%]{resize:vertical;min-height:100px}.form-actions[_ngcontent-%COMP%]{display:flex;gap:1rem;justify-content:flex-end;margin-top:2rem;padding-top:1rem;border-top:1px solid rgba(255,255,255,.1)}.btn-primary[_ngcontent-%COMP%]{background:#00d4ff;color:#0f0f23;border:none;padding:.75rem 1.5rem;border-radius:6px;font-weight:600;cursor:pointer;transition:all .3s ease}.btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){background:#00a8cc;transform:translateY(-2px)}.btn-primary[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed;transform:none}.btn-secondary[_ngcontent-%COMP%]{background:#ffffff1a;color:#fff;border:1px solid rgba(255,255,255,.2);padding:.75rem 1.5rem;border-radius:6px;cursor:pointer;transition:all .3s ease}.btn-secondary[_ngcontent-%COMP%]:hover{background:#fff3}@media(max-width:768px){.client-form[_ngcontent-%COMP%]{padding:1rem}.form-row[_ngcontent-%COMP%]{grid-template-columns:1fr}.form-header[_ngcontent-%COMP%]{flex-direction:column;gap:1rem;align-items:stretch}.form-actions[_ngcontent-%COMP%]{flex-direction:column}}"]})};export{ie as ClientFormComponent};
